"use strict";(self["webpackChunkwork"]=self["webpackChunkwork"]||[]).push([[920],{1920:function(t,e,s){s.r(e),s.d(e,{default:function(){return l}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"back"},[s("div",{staticClass:"info"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),s("el-breadcrumb-item",[t._v("用户管理")])],1)],1),s("div",{staticClass:"search"},[s("el-input",{staticClass:"date",attrs:{placeholder:"请输入用户名或id",maxlength:"16"},model:{value:t.searchInfo,callback:function(e){t.searchInfo=e},expression:"searchInfo"}}),s("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"medium"},on:{click:t.search}},[t._v("搜索用户")])],1),s("div",[s("el-table",{attrs:{data:t.users}},[s("el-table-column",{attrs:{prop:"id",label:"用户id",width:"100"}}),s("el-table-column",{attrs:{prop:"userName",label:"用户名",width:"180"}}),s("el-table-column",{attrs:{prop:"email",label:"用户邮箱",width:"180"}}),s("el-table-column",{attrs:{prop:"status",label:"用户状态",width:"100"}}),s("el-table-column",{attrs:{prop:"power",label:"用户权限",width:"100"}}),s("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return["普通用户"===e.row.power?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.changePower(e.row.id,!0)}}},[t._v("设为管理员")]):s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.changePower(e.row.id,!1)}}},[t._v("取消管理员")]),"正常"===e.row.status?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.changeStatus(e.row.id,!0)}}},[t._v("封禁")]):s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.changeStatus(e.row.id,!1)}}},[t._v("解封")])]}}])})],1)],1),s("div",{staticClass:"page"},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.totalPages,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.getPageNum}})],1)])},r=[],o={data(){return{searchInfo:"",saveInfo:"",totalPages:100,currentPage:1,users:[]}},methods:{getDate(t){if(""===t)return"";let e=new Date(t);return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()},print(t){console.log(t)},getPageNum(t){this.getPage(this.currentPage)},changePower(t,e){this.$axios({method:"POST",url:"/manager/setPower",params:{id:t,power:e}}).then((s=>{let a=s.data;1==a.status?(this.$message({message:"设置成功",type:"success"}),this.users.forEach((function(s,a,r){s.id===t&&(r[a].power=e?"管理员":"普通用户")}))):0==a.status?this.$message({message:"不能对自己进行操作!",type:"warning"}):2==a.status?(this.$store.state.status=2,this.$store.dispatch("setIsManager",!1),this.goto("/user/userInfo")):(this.$store.state.status=1,this.$store.state.hasLogin=!1,this.$store.state.isManager=!1,this.$store.state.userName="",this.$store.state.email="",this.$store.state.userId="",localStorage.clear(),this.goto("/"))}))},changeStatus(t,e){this.$axios({method:"POST",url:"/manager/setStatus",params:{id:t,status:e}}).then((s=>{let a=s.data;1==a.status?(this.$message({message:"设置成功",type:"success"}),this.users.forEach((function(s,a,r){s.id===t&&(r[a].status=e?"封禁中":"正常")}))):0==a.status?this.$message({message:"不能对自己进行操作!",type:"warning"}):2==a.status?(this.$store.state.status=2,this.$store.dispatch("setIsManager",!1),this.goto("/user/userInfo")):(this.$store.state.status=1,this.$store.state.hasLogin=!1,this.$store.state.isManager=!1,this.$store.state.userName="",this.$store.state.email="",this.$store.state.userId="",localStorage.clear(),this.goto("/"))}))},search(){this.saveInfo=this.searchInfo,this.getPage(1)},getPage(t){this.$axios({method:"GET",url:"/manager/searchUsers",params:{info:this.saveInfo,page:t,number:8}}).then((t=>{let e=t.data;1==e.status?(this.users=e.users,this.totalPages=10*e.pages,this.currentPage=e.currentPage):0==e.status?this.$message.error("未知错误!"):2==e.status?(this.$store.state.status=2,this.$store.dispatch("setIsManager",!1),this.goto("/user/userInfo")):(this.$store.state.status=1,this.$store.state.hasLogin=!1,this.$store.state.isManager=!1,this.$store.state.userName="",this.$store.state.email="",this.$store.state.userId="",localStorage.clear(),this.goto("/"))}))}},mounted(){this.getPage(this.currentPage)}},i=o,n=s(1001),u=(0,n.Z)(i,a,r,!1,null,"433ed0aa",null),l=u.exports}}]);
//# sourceMappingURL=920.7e6fbe03.js.map
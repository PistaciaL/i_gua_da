"use strict";(self["webpackChunkwork"]=self["webpackChunkwork"]||[]).push([[374],{5374:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"back"},[a("div",{staticClass:"info"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("用户管理")])],1)],1),a("div",{staticClass:"search"},[a("el-input",{staticClass:"date",attrs:{placeholder:"请输入用户名或id",maxlength:"16"},model:{value:t.searchInfo,callback:function(e){t.searchInfo=e},expression:"searchInfo"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"medium"},on:{click:t.search}},[t._v("搜索用户")])],1),a("div",[a("el-table",{attrs:{data:t.users}},[a("el-table-column",{attrs:{prop:"id",label:"用户id",width:"100"}}),a("el-table-column",{attrs:{prop:"userName",label:"用户名",width:"180"}}),a("el-table-column",{attrs:{prop:"email",label:"用户邮箱",width:"180"}}),a("el-table-column",{attrs:{prop:"status",label:"用户状态",width:"100"}}),a("el-table-column",{attrs:{prop:"power",label:"用户权限",width:"100"}}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return["普通用户"===e.row.power?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.changePower(e.row.id,!0)}}},[t._v("设为管理员")]):a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.changePower(e.row.id,!1)}}},[t._v("取消管理员")]),"正常"===e.row.status?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.changeStatus(e.row.id,!0)}}},[t._v("封禁")]):a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.changeStatus(e.row.id,!1)}}},[t._v("解封")])]}}])})],1)],1),a("div",[a("el-pagination",{staticClass:"page",attrs:{background:"",layout:"prev, pager, next",total:t.totalPages,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.getPageNum}})],1)])},r=[],o=(a(1539),a(4747),{data:function(){return{searchInfo:"",saveInfo:"",totalPages:100,currentPage:1,users:[]}},methods:{getDate:function(t){if(""===t)return"";var e=new Date(t);return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()},print:function(t){console.log(t)},getPageNum:function(t){this.getPage(this.currentPage)},changePower:function(t,e){var a=this;this.$axios({method:"POST",url:"/manager/setPower",data:{id:t,power:e}}).then((function(s){var r=s.data;1==r.status?(a.$message({message:"设置成功",type:"success"}),a.users.forEach((function(a,s,r){a.id===t&&(r[s].power=e?"管理员":"普通用户")}))):0==r.status?a.$message({message:"不能对自己进行操作!",type:"warning"}):2==r.status?(a.$store.state.status=2,a.$store.dispatch("setIsManager",!1),a.goto("/user/userInfo")):(a.$store.state.status=1,a.$store.state.hasLogin=!1,a.$store.state.isManager=!1,a.$store.state.userName="",a.$store.state.email="",a.$store.state.userId="",localStorage.clear(),a.goto("/"))}))},changeStatus:function(t,e){var a=this;this.$axios({method:"POST",url:"/manager/setStatus",data:{id:t,status:e}}).then((function(s){var r=s.data;1==r.status?(a.$message({message:"设置成功",type:"success"}),a.users.forEach((function(a,s,r){a.id===t&&(r[s].status=e?"封禁中":"正常")}))):0==r.status?a.$message({message:"不能对自己进行操作!",type:"warning"}):2==r.status?(a.$store.state.status=2,a.$store.dispatch("setIsManager",!1),a.goto("/user/userInfo")):(a.$store.state.status=1,a.$store.state.hasLogin=!1,a.$store.state.isManager=!1,a.$store.state.userName="",a.$store.state.email="",a.$store.state.userId="",localStorage.clear(),a.goto("/"))}))},search:function(){this.saveInfo=this.searchInfo,this.getPage(1)},getPage:function(t){var e=this;this.$axios({method:"GET",url:"/manager/searchUsers",params:{info:this.saveInfo,page:t,number:8}}).then((function(t){var a=t.data;1==a.status?(e.users=a.users,e.totalPages=10*a.pages,e.currentPage=a.currentPage):0==a.status?e.$message.error("未知错误!"):2==a.status?(e.$store.state.status=2,e.$store.dispatch("setIsManager",!1),e.goto("/user/userInfo")):(e.$store.state.status=1,e.$store.state.hasLogin=!1,e.$store.state.isManager=!1,e.$store.state.userName="",e.$store.state.email="",e.$store.state.userId="",localStorage.clear(),e.goto("/"))}))}},mounted:function(){this.getPage(this.currentPage)}}),n=o,u=a(1001),i=(0,u.Z)(n,s,r,!1,null,"03a4543c",null),c=i.exports}}]);
//# sourceMappingURL=374-legacy.444891a1.js.map
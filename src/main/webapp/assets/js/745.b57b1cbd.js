"use strict";(self["webpackChunkwork"]=self["webpackChunkwork"]||[]).push([[745],{4745:function(t,e,s){s.r(e),s.d(e,{default:function(){return h}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"back"},[s("div",{staticClass:"info"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),s("el-breadcrumb-item",[t._v("校车管理")])],1)],1),s("div",{staticClass:"search"},[s("el-date-picker",{staticClass:"date",attrs:{type:"date",placeholder:"开始日期"},model:{value:t.start,callback:function(e){t.start=e},expression:"start"}}),s("span",[t._v("到")]),s("el-date-picker",{staticClass:"date",attrs:{type:"date",placeholder:"结束日期"},model:{value:t.end,callback:function(e){t.end=e},expression:"end"}}),s("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"medium"},on:{click:t.search}},[t._v("搜索班次")]),s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"medium"},on:{click:function(e){t.showAdd=!0}}},[t._v("增加班次")])],1),s("div",[s("el-table",{attrs:{data:t.times}},[s("el-table-column",{attrs:{prop:"id",label:"班次编号",width:"180"}}),s("el-table-column",{attrs:{prop:"time",label:"出发时间",width:"180"}}),s("el-table-column",{attrs:{prop:"start",label:"出发车站",width:"100"}}),s("el-table-column",{attrs:{prop:"end",label:"目的车站",width:"180"}}),s("el-table-column",{attrs:{prop:"number",label:"剩余空位",width:"100"}}),s("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{staticClass:"el-icon-delete-solid",attrs:{type:"text",size:"small"},on:{click:function(s){return t.del(e.row.id)}}},[t._v("删除")])]}}])})],1)],1),s("div",{staticClass:"page"},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.totalPages,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.getPageNum}})],1),s("el-dialog",{attrs:{visible:t.showAdd,width:"30%",center:"","close-on-click-modal":!1,"lock-scroll":!1,"before-close":t.clear},on:{"update:visible":function(e){t.showAdd=e}}},[s("div",{staticClass:"add"},[s("h2",[t._v("新增校车班次")]),s("el-date-picker",{staticClass:"add-date",attrs:{type:"date",placeholder:"发车日期"},model:{value:t.newDate,callback:function(e){t.newDate=e},expression:"newDate"}}),s("span",[t._v("--")]),s("el-time-select",{staticClass:"add-date",attrs:{"picker-options":{start:"00:00",step:"1:00",end:"24:00"},placeholder:"发车时间"},model:{value:t.newTime,callback:function(e){t.newTime=e},expression:"newTime"}}),s("el-select",{staticClass:"input",attrs:{placeholder:"始发站"},model:{value:t.newStart,callback:function(e){t.newStart=e},expression:"newStart"}},[s("el-option",{attrs:{label:"长安校区",value:"长安校区"}}),s("el-option",{attrs:{label:"友谊校区",value:"友谊校区"}})],1),s("el-select",{staticClass:"input",attrs:{placeholder:"终点站"},model:{value:t.newEnd,callback:function(e){t.newEnd=e},expression:"newEnd"}},[s("el-option",{attrs:{label:"长安校区",value:"长安校区"}}),s("el-option",{attrs:{label:"友谊校区",value:"友谊校区"}})],1),s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"medium"},on:{click:t.add}},[t._v("增加班次")])],1)])],1)},i=[],r={data(){return{start:"",end:"",saveStart:"",saveEnd:"",showAdd:!1,totalPages:100,currentPage:1,newDate:"",newTime:"",newStart:"",newEnd:"",times:[]}},methods:{goto(t){this.$router.push({path:t})},getDate(t){if(""===t)return"";let e=new Date(t);return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()},getPageNum(t){this.getPage(this.currentPage)},getTime(){return this.getDate(this.newDate)+" "+this.newTime},add(){""===this.newDate||""===this.newTime||""==this.newStart||""==this.newEnd?this.$message({message:"输入不能为空!",type:"warning"}):this.newStart==this.newEnd?this.$message({message:"起点不能和终点一样!",type:"warning"}):this.$axios({method:"POST",url:"/manager/addTime",data:{page:this.currentPage,number:8,startTime:this.getDate(this.saveStart),endTime:this.getDate(this.saveEnd),time:this.getTime(),start:this.newStart,end:this.newEnd}}).then((t=>{let e=t.data;1==e.status?(this.times=e.times,this.totalPages=10*e.pages,this.currentPage=e.currentPage,this.newDate="",this.newTime="",this.newStart="",this.newEnd="",this.showAdd=!1,this.$message({message:"添加成功",type:"success"})):0==e.status?this.$message({message:"日期输入错误!",type:"warning"}):2==e.status?(this.$store.state.status=2,this.$store.dispatch("setIsManager",!1),this.goto("/user/userInfo")):(this.$store.state.status=1,this.$store.state.hasLogin=!1,this.$store.state.isManager=!1,this.$store.state.userName="",this.$store.state.email="",this.$store.state.userId="",localStorage.clear(),this.goto("/"))}))},del(t){this.$axios({method:"POST",url:"/manager/delTime",data:{id:t,page:this.currentPage,number:8,startTime:this.getDate(this.saveStart),endTime:this.getDate(this.saveEnd)}}).then((e=>{let s=e.data;1==s.status?(this.times=s.times,this.totalPages=10*s.pages,this.currentPage=s.currentPage,this.$message({message:"删除成功,校车班次id为"+t,type:"success"})):0==s.status?this.$message.error("删除失败!"):2==s.status?(this.$store.state.status=2,this.$store.dispatch("setIsManager",!1),this.goto("/user/userInfo")):(this.$store.state.status=1,this.$store.state.hasLogin=!1,this.$store.state.isManager=!1,this.$store.state.userName="",this.$store.state.email="",this.$store.state.userId="",localStorage.clear(),this.goto("/"))}))},search(){this.saveStart=this.start,this.saveEnd=this.end,this.getPage(1)},getPage(t){this.$axios({method:"GET",url:"/manager/searchTimes",params:{page:t,number:8,startTime:this.getDate(this.saveStart),endTime:this.getDate(this.saveEnd)}}).then((t=>{let e=t.data;1==e.status?(this.times=e.times,this.totalPages=10*e.pages,this.currentPage=e.currentPage):0==e.status?this.$message({message:"日期输入有误!",type:"warning"}):2==e.status?(this.$store.state.status=2,this.$store.dispatch("setIsManager",!1),this.goto("/user/userInfo")):(this.$store.state.status=1,this.$store.state.hasLogin=!1,this.$store.state.isManager=!1,this.$store.state.userName="",this.$store.state.email="",this.$store.state.userId="",localStorage.clear(),this.goto("/"))}))},clear(t){this.newDate="",this.newTime="",this.newStart="",this.newEnd="",t()}},mounted(){this.getPage(this.currentPage)}},n=r,l=s(1001),o=(0,l.Z)(n,a,i,!1,null,"a59ce67a",null),h=o.exports}}]);
//# sourceMappingURL=745.b57b1cbd.js.map
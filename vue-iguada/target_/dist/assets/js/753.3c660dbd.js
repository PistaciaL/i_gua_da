"use strict";(self["webpackChunkwork"]=self["webpackChunkwork"]||[]).push([[753],{7753:function(s,t,e){e.r(t),e.d(t,{default:function(){return u}});var i=function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("div",{staticClass:"back"},[i("div",{staticClass:"nav"},[i("img",{attrs:{src:e(5080)}}),0==s.$store.state.hasLogin?i("div",[i("span",{staticClass:"click",on:{click:function(t){s.showLogin=!0,s.showRegister=!1}}},[s._v("登录")]),i("span",[s._v("  或  ")]),i("span",{staticClass:"click",on:{click:function(t){s.showRegister=!0,s.showLogin=!1}}},[s._v("注册")])]):i("div",[i("span",[s._v("欢迎您!"+s._s(s.userName))]),i("span",{staticClass:"click",on:{click:function(t){return s.logout()}}},[s._v("  退出登录")])])]),i("div",{staticClass:"content"},[i("div",{staticClass:"clearfix"},[i("div",{staticClass:"menu-child"},[i("i",{staticClass:"el-icon-user-solid"}),i("h2",[s._v("个人主页")]),i("p",[s._v("包含个人信息，预约信息等信息，提供预约校车，留言反馈，查看校车班次等服务")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return s.goto("/user/userInfo")}}},[s._v("点击进入")])],1),i("div",{staticClass:"menu-child"},[i("i",{staticClass:"el-icon-s-promotion"}),i("h2",[s._v("预约校车")]),i("p",[s._v("可进行查询当前可预约校车，校车剩余座位，预约校车等操作")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return s.goto("/user/busTime")}}},[s._v("点击进入")])],1),i("div",{staticClass:"menu-child"},[i("i",{staticClass:"el-icon-message-solid"}),i("h2",[s._v("留言反馈")]),i("p",[s._v("留下您宝贵的意见，您的建议是我们不断前进的最大动力！")]),i("el-button",{attrs:{type:"primary"}},[s._v("点击进入")])],1),i("div",{staticClass:"menu-child"},[i("i",{staticClass:"el-icon-s-platform"}),i("h2",[s._v("管理系统")]),i("p",[s._v("具有管理员权限的用户可以进入后台对用户，校车班次表等进行管理")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return s.goto("/manager/busManage")}}},[s._v("点击进入")])],1)])]),i("div",{staticClass:"info clearfix"},[i("div",{staticClass:"time"},[i("h2",[s._v("今日校车排班")]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:s.timeLoading,expression:"timeLoading"}],attrs:{data:s.times,"row-class-name":s.tableRowClassName,"max-height":"300","header-cell-style":{background:"#F1F7FF"}}},[i("el-table-column",{attrs:{prop:"time",label:"出发时间",width:"180"}}),i("el-table-column",{attrs:{prop:"start",label:"出发车站",width:"100"}}),i("el-table-column",{attrs:{prop:"end",label:"目的车站",width:"100"}}),i("el-table-column",{attrs:{prop:"number",label:"剩余空位",width:"100"}})],1)],1),i("div",{staticClass:"notice"},[i("h2",[s._v("公告通知")]),i("el-carousel",{directives:[{name:"loading",rawName:"v-loading",value:s.noticeLoading,expression:"noticeLoading"}],attrs:{"indicator-position":"outside",height:"270px"}},s._l(s.notices,(function(t){return i("el-carousel-item",{key:t.id},[i("h3",{staticClass:"notice-title"},[s._v(s._s(t.title))]),i("p",{staticClass:"notice-content"},[s._v("    "+s._s(t.content))])])})),1)],1)]),i("div",{staticClass:"bottom"},[i("div",{staticClass:"bottom-logo"},[i("img",{staticClass:"logo2",attrs:{src:e(1823)}})]),i("div",{staticClass:"line"}),s._m(0),i("div",{staticClass:"bottom-logo2"},[i("img",{staticClass:"logo3",attrs:{src:e(237)}})])]),i("el-dialog",{attrs:{visible:s.showLogin,width:"30%",center:"","close-on-click-modal":!1,"before-close":s.beforeClose,"lock-scroll":!1},on:{"update:visible":function(t){s.showLogin=t}}},[i("div",{staticClass:"login"},[i("h2",[s._v("登录账号")]),i("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户名",maxlength:"16"},model:{value:s.userName,callback:function(t){s.userName=t},expression:"userName"}}),i("el-input",{attrs:{"prefix-icon":"el-icon-lock",placeholder:"请输入密码","show-password":"",maxlength:"16"},model:{value:s.password,callback:function(t){s.password=t},expression:"password"}}),i("p",{staticClass:"forget click",on:{click:function(t){return s.goto("/reset")}}},[s._v("忘记密码？")]),i("p",[s._v(s._s(s.loginError))]),i("el-button",{attrs:{type:"primary"},on:{click:s.login}},[s._v("登录")]),i("el-button",{on:{click:function(t){s.showRegister=!0,s.showLogin=!1,s.clearData()}}},[s._v("注册账号")]),i("span",[s._v("登录注册即代表同意i瓜大《用户协议》和《隐私协议》")])],1)]),i("el-dialog",{attrs:{visible:s.showRegister,width:"30%",center:"","close-on-click-modal":!1,"before-close":s.beforeClose,"lock-scroll":!1},on:{"update:visible":function(t){s.showRegister=t}}},[i("div",{staticClass:"register"},[i("h2",[s._v("注册账号")]),i("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户名",maxlength:"16"},model:{value:s.userName,callback:function(t){s.userName=t},expression:"userName"}}),i("el-input",{attrs:{"prefix-icon":"el-icon-s-promotion",placeholder:"请输入学工号",maxlength:"16"},model:{value:s.userId,callback:function(t){s.userId=t},expression:"userId"}}),i("el-input",{attrs:{"prefix-icon":"el-icon-message",placeholder:"请输入邮箱",maxlength:"16"},model:{value:s.email,callback:function(t){s.email=t},expression:"email"}}),i("el-input",{attrs:{"prefix-icon":"el-icon-lock",placeholder:"请输入密码","show-password":"",maxlength:"16"},model:{value:s.registerPassword,callback:function(t){s.registerPassword=t},expression:"registerPassword"}}),i("el-input",{attrs:{"prefix-icon":"el-icon-lock",placeholder:"请再次输入密码","show-password":"",maxlength:"16"},model:{value:s.passwordAgain,callback:function(t){s.passwordAgain=t},expression:"passwordAgain"}}),i("p",[s._v(s._s(s.registerError))]),i("el-button",{attrs:{type:"warning"},on:{click:s.register}},[s._v("注册")]),i("el-button",{on:{click:function(t){s.showLogin=!0,s.showRegister=!1,s.clearData()}}},[s._v("已有账号")]),i("span",[s._v("登录注册即代表同意i瓜大《用户协议》和《隐私协议》")])],1)])],1)},a=[function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"bottom-info"},[e("p",[s._v("i瓜大开发团队,联系电话:18322805616")]),e("p",[s._v("团队成员:刘智宇,康弘,卜欣阳,董保朔,冶小东")]),e("p",[s._v("地址:西北工业大学长安校区")]),e("p",[s._v("版权所有 © i瓜大开发团队")])])}],r=e(4102);let o=new r.X;var l={data(){return{userName:"",password:"",registerPassword:"",passwordAgain:"",email:"",userId:"",showLogin:!1,showRegister:!1,loginError:"",registerError:"",timeLoading:!0,noticeLoading:!0,notices:[],times:[]}},methods:{goto(s){let t=!0;0==s.indexOf("/user")?0==this.$store.state.hasLogin&&(this.showLogin=!0,t=!1):0==s.indexOf("/manager")&&0==this.$store.state.isManager&&(this.$message.error("您无管理员权限!"),t=!1),t&&this.$router.push({path:s})},tableRowClassName({row:s,rowIndex:t}){return"row"},logout(){this.$axios({method:"POST",url:"/logout"}).then((s=>{let t=s.data;1===t.status&&(this.userName="",this.$store.state.hasLogin=!1,this.$store.state.isManager=!1,this.$store.state.userName="",this.$store.state.email="",this.$store.state.userId="",localStorage.clear(),this.clearData())}))},login(){""==this.userName||""==this.password?this.loginError="输入为空!":(o.setPublicKey(this.$store.state.publicKey),this.$axios({method:"POST",url:"/login",data:{userName:this.userName,password:this.password}}).then((s=>{let t=s.data;1===t.status?(this.userName=t.user.userName,this.$store.dispatch("setUserName",t.user.userName),this.$store.dispatch("setHasLogin",!0),this.$store.dispatch("setIsManager",t.user.isManager),this.$store.dispatch("setEmail",t.user.email),this.$store.dispatch("setUserId",t.user.userId),this.clearData(),this.showLogin=!1):0==t.status?this.loginError="登录失败,用户名或密码错误":this.loginError="您的已账户被封禁，禁止登录"})))},register(){""==this.userName||""==this.userId||""==this.email||""==this.registerPassword||""==this.passwordAgain?this.registerError="输入不能为空!":0==this.checkEmail(this.email)?this.registerError="邮箱格式不正确!":this.registerPassword!=this.passwordAgain?this.registerError="两次输入的密码不一致":(o.setPublicKey(this.$store.state.publicKey),this.$axios({method:"POST",url:"/register",data:{userName:this.userName,password:this.registerPassword,email:this.email,userId:this.userId}}).then((s=>{let t=s.data;0==t.status?this.registerError="注册失败,该账户已被注册":(this.userName=t.userName,this.$store.dispatch("setUserName",t.user.userName),this.$store.dispatch("setHasLogin",!0),this.$store.dispatch("setIsManager",t.user.isManager),this.$store.dispatch("setEmail",t.user.email),this.$store.dispatch("setUserId",t.user.userId),this.clearData(),this.showRegister=!1)})))},beforeClose(s){this.userName="",this.clearData(),s()},clearData(){this.registerError="",this.loginError="",this.password="",this.registerPassword="",this.passwordAgain="",this.email="",this.userId=""},checkEmail(s){return/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(s)}},mounted(){this.userName=this.$store.state.userName,this.$axios({method:"GET",url:"/getTodayTimes"}).then((s=>{let t=s.data;this.times=t,this.timeLoading=!1})),this.$axios({method:"GET",url:"/getNoitces"}).then((s=>{let t=s.data;this.notices=t,this.noticeLoading=!1})),1==this.$store.state.status&&(this.$message.error("您的session已经失效,请重新登录!"),this.$store.state.status=0)}},n=l,c=e(1001),h=(0,c.Z)(n,i,a,!1,null,"7237cd80",null),u=h.exports}}]);
//# sourceMappingURL=753.3c660dbd.js.map